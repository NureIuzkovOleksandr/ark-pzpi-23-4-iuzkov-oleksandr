Харківський національний університет радіоелектроніки
Факультет комп’ютерних наук
Катедра програмної інженерії


Звіт
з лабораторної роботи № 5
з дисципліни «Аналіз та рефакторинг коду»
на тему «Розгортання програмної системи та демонстрація її роботи»




    Виконав:                                                                           Перевірив:
ст. гр. ПЗПІ-23-4                                                              ст. викладач кафедри ПІ
Юзков Олександр                                            	         Сокорчук Ігор Петрович



Харків 2025
1 ІСТОРІЯ ЗМІН

№ДатаВерсія звітуОпис змін та виправлень120.12.20250.1Зроблено звіт
2 ЗАВДАННЯ
     Ця робота спрямована на отримання практичного досвіду з встановлення та запуску програмного забезпечення в операційному середовищі, тестування його правильної та безперебійної роботи, а також виконання базових і додаткових конфігурацій. Під час виконання завдання планується детально вивчити процес введення системи в експлуатацію, проаналізувати її функціонування, знайти потенційні збої та визначити методи їх виправлення. Особливу увагу приділено представленню роботи програмного продукту та його належному оформленню в документації для майбутнього застосування, технічної підтримки та розширення функціональності.
3 ОПИС ВИКОНАНОЇ РОБОТИ
     Темою проєкту для виконання лабораторних робіт є програмна система контролю мікроклімату у приміщеннях. 
     Розгортання системи здійснюється з використанням технології контейнеризації Docker, що дозволяє забезпечити ізольоване, відтворюване та незалежне від середовища виконання розгортання застосунку. Для локальної розробки та запуску сервісів використовується Docker Compose. Система побудована на основі веб-фреймворку FastAPI та виконується у середовищі Python 3.11.
     Для створення Docker-образу використовується файл Dockerfile із застосуванням техніки "multi-stage build", що дозволяє оптимізувати розмір фінального образу та відокремити етап встановлення залежностей від етапу виконання (Додаток В).
     Перший етап (builder) — підготовка залежностей:
* базовим образом обрано офіційний образ "python:3.11-slim", який містить необхідне середовище виконання Python; 
* встановлення робочої директорії "/app"; 
* копіювання файлу "requirements.txt" з переліком залежностей проєкту; 
* встановлення Python-пакетів за допомогою команди "pip install --no-cache-dir -r requirements.txt"; 
* копіювання вихідного коду застосунку: модулів "main.py", "database.py", "models.py", "schemas.py", "auth.py", "admin.py" та "business_logic.py".
   Другий етап (runtime) — створення фінального образу:
* базовим образом обрано легковісний образ "python:3.11-slim", який містить лише середовище виконання Python; 
* встановлення робочої директорії "/app"; 
* відкриття порту 8000 для HTTP-трафіку; 
* копіювання встановлених залежностей та коду застосунку з етапу збірки; 
     Таким чином, Docker-образ містить лише необхідні залежності для коректної роботи FastAPI застосунку, що значно зменшує його розмір порівняно з образом, що містить додаткові інструменти розробки.
     Керування контейнерами за допомогою Docker Compose
     Для керування контейнерами використовується файл "docker-compose.yaml", у якому описано два сервіси: postgres та api (Додаток В).
     Сервіс postgres — база даних PostgreSQL:
* "image" — використання офіційного образу "postgres:15-alpine"; 
* "environment" — налаштування імені бази даних, користувача та пароля адміністратора; 
* "ports" — переброс порту 5432 контейнера на порт 5432 хост-машини; 
* "volumes" — монтування тому для збереження даних бази; 
* "healthcheck" — перевірка готовності бази даних за допомогою команди "pg_isready" перед запуском залежних сервісів.
   Сервіс api — веб-застосунок системи контролю мікроклімату:
* "build" — створення образу на основі Dockerfile;
* "depends_on" — залежність від сервісу postgres з умовою перевірки здоров'я (service_healthy);
* "environment" — налаштування змінних середовища, включаючи рядок підключення до бази даних PostgreSQL;
* "ports" — переброс порту 8000 контейнера на порт 8000 хост-машини.

     Використання Docker Compose дає змогу зосереджено керувати налаштуваннями сервісів і суттєво полегшує локальний запуск та тестування системи.
     Розгортання у хмарному середовищі Microsoft Azure
     Для розгортання серверної частини системи в продакшн-середовищі було використано хмарну платформу Microsoft Azure, вибір якої зумовлений надійною інфраструктурою, широким набором керованих сервісів, гнучкими можливостями масштабування та економічною доцільністю для проєктів різного масштабу.
     Архітектура розгортання включає наступні компоненти Azure:
     Azure Database for PostgreSQL — керована реляційна база даних:
* повна сумісність із PostgreSQL; 
* автоматичне резервне копіювання та відновлення даних; 
* вбудоване шифрування даних у стані спокою та під час передачі; 
* автоматичне масштабування обчислювальних ресурсів; 
* висока доступність без додаткового налаштування.
   Azure Container Registry (ACR) — приватний реєстр Docker-образів:
* безпечне зберігання Docker-образів застосунку; 
* інтеграція з Azure Container Apps для автоматичного розгортання; 
* підтримка geo-реплікації для зменшення затримок доступу; 
* автоматичне сканування образів на наявність вразливостей безпеки.
     Azure Container Apps — платформа для запуску контейнеризованих застосунків:
* розгортання вебзастосунків без потреби в ручному налаштуванні серверної інфраструктури;
* автоматичне масштабування відповідно до рівня навантаження, зокрема з можливістю масштабування до нуля реплік;
* вбудовані механізми балансування навантаження та автоматичної конфігурації HTTPS;
* автоматичний перезапуск сервісів у разі виникнення збоїв;
* централізоване керування змінними середовища та секретами за допомогою Azure Portal або CLI.
База даних
     Для зберігання даних у системі використовується реляційна база даних PostgreSQL, яка має тісну інтеграцію з FastAPI завдяки ORM SQLAlchemy. Основні причини вибору реляційної бази даних:
* підтримка складних взаємозв’язків між сутностями даних;
* забезпечення цілісності даних за рахунок використання транзакцій та обмежень;
* зручний механізм міграції структури бази даних із застосуванням EF Core Migrations;
* висока надійність і можливість масштабування;
* розширений функціонал для роботи з даними, зокрема збережені процедури, тригери та індекси.
     Використання Azure Database for PostgreSQL як керованого сервісу дає змогу зменшити складність адміністрування та гарантує високу доступність системи.
     Протокол взаємодії
     Для обміну даними між клієнтом і сервером у системі використовується протокол HTTP/HTTPS, який є загальноприйнятим стандартом для вебзастосунків. Основні переваги застосування HTTP/HTTPS:
* сумісність із веббраузерами та мобільними клієнтами;
* підтримка архітектурного підходу RESTful API;
* можливість безпечного передавання даних завдяки використанню HTTPS;
* простота інтеграції із зовнішніми сервісами та системами моніторингу.
     Обмін даними відбувається у форматі JSON, який є легким, зрозумілим і зручним для обробки як на серверній, так і на клієнтській стороні.
     Архітектура застосунку
     Застосунок організовано за модульним принципом, що забезпечує чіткий розподіл відповідальності між компонентами:
* "main.py" — точка входу застосунку, ініціалізація FastAPI, налаштування маршрутів;
* "database.py" — конфігурація підключення до бази даних, створення сесій SQLAlchemy;
* "models.py" — визначення моделей даних (таблиць бази даних);
* "schemas.py" — Pydantic-схеми для валідації вхідних та вихідних даних API;
* "auth.py" — логіка аутентифікації та авторизації користувачів;
* "admin.py" — адміністративні функції управління системою;
* "business_logic.py" — бізнес-логіка обробки даних від датчиків, формування сповіщень та керування обладнанням.
     Така організація забезпечує легкість у підтримці, тестуванні та розширенні функціональності системи.
Використання Docker дозволяє ізолювати застосунок разом із усіма залежностями та середовищем виконання, що суттєво знижує ризик помилок через відмінності середовищ і гарантує однакову поведінку системи як у локальному, так і в продакшн-середовищі.
Обраний стек технологій (Docker, FastAPI, SQLAlchemy, PostgreSQL, Azure Container Apps, Azure Database for PostgreSQL, Azure Container Registry, HTTP/HTTPS) забезпечує надійне, масштабоване та зручне розгортання системи контролю мікроклімату в приміщеннях.
     
     
     
     
     
     
     
     
     
     
4 ВИСНОВКИ
     У процесі виконання цієї роботи було успішно опановано розгортання програмної системи, перевірено її працездатність та здійснено необхідні налаштування для забезпечення коректного функціонування. Отримані результати підтверджують правильність виконаних дій та стабільність роботи системи. Крім того, здобуто досвід демонстрації роботи програмного продукту та підготовки технічної документації, що є важливим етапом життєвого циклу програмного забезпечення. Загалом, виконання роботи сприяло поглибленню практичних знань і навичок, необхідних для ефективної роботи з програмними системами в реальних умовах.
5 ВИКОРИСТАНІ ДЖЕРЕЛА
1. Методичні вказівки до лабораторних робіт з дисципліни «Аналіз та рефакторинг коду програмного забезпечення» (дата звернення: 25.10.2025).
2. Wokwi - World's most advanced ESP32 Simulator. Wokwi - World's most advanced ESP32 Simulator. URL: https://wokwi.com/ (дата звернення: 25.12.2025).















ДОДАТОК А
Відеозапис
Відеозапис презентації результатів лабораторної роботи: https://youtu.be/iwKDWTJsmxo
Хронологічний опис відеозапису:
00:00 – Вступ 
00:15 – Опис виконаної роботи

















ДОДАТОК В
Програмний код
GitHub репозиторій: https://github.com/NureIuzkovOleksandr/ark-pzpi-23-4-iuzkov-oleksandr/tree/main/Lab5/ark-pzpi-23-4-iuzkov-oleksandr-lab5
В.1 Код Dockerfile.
1. FROM python:3.11-slim
2. 
3. ENV PYTHONDONTWRITEBYTECODE=1
4. ENV PYTHONUNBUFFERED=1
5. 
6. WORKDIR /app
7. 
8. RUN apt-get update && apt-get install -y \
9.     gcc \
10.     libpq-dev \
11.     && rm -rf /var/lib/apt/lists/*
12. 
13. COPY requirements.txt .
14. RUN pip install --no-cache-dir -r requirements.txt
15. 
16. COPY ./app ./app
17. 
18. EXPOSE 8000
19. 
20. CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]

В.2 Код docker-compose.yaml.
1. version: "3.9"
2. 
3. services:
4.   db:
5.     image: postgres:15
6.     container_name: climate_postgres
7.     restart: always
8.     environment:
9.       POSTGRES_USER: postgres
10.       POSTGRES_PASSWORD: postgres
11.       POSTGRES_DB: climate_monitoring
12.     ports:
13.       - "5432:5432"
14.     volumes:
15.       - postgres_data:/var/lib/postgresql/data
16. 
17.   api:
18.     build: .
19.     container_name: climate_api
20.     restart: always
21.     env_file:
22.       - .env
23.     depends_on:
24.       - db
25.     ports:
26.       - "8000:8000"
27.     volumes:
28.       - ./app:/app/app
29. 
30. volumes:
31.   postgres_data:


2










